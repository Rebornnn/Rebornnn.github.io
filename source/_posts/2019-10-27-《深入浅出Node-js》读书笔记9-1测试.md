---
title: 《深入浅出Node.js》读书笔记9-1测试
date: 2019-10-27 13:04:29
categories:
- 读书笔记
- 《深入浅出node.js》
tags:
- node
- 系统学习
description: 测试
---
## 单元测试
### 可测试代码的原则
- 单一职责
- 接口抽象
- 层次分离

### 单元测试介绍
单元测试主要包括断言、测试框架、测试用例、测试覆盖率、mock、持续集成等几个方面，由于Node的特殊性，它还会加入异步代码测试和私有方法的测试两个部分。

#### 1. 断言
断言的用途： 单元测试中用来保证最小单元是否正常的检测方法，检查程序在运行时是否满足期望。   
Node中存在assert模块，很多断言库是基于assert模块进行封装和扩展的。

#### 2. 测试框架
前面提到断言一旦检查失败，将会抛出异常停止整个应用，这对于大规模断言检查时并不友好。更通用的做法是，记录下抛出的异常并继续执行，最后生成测试报告。

##### 测试风格
测试用例的不同组织方式成为测试风格，主要有两种TDD(测试驱动开发)和BDD(行为驱动开发),它们差别如下：
- 关注点不同。TDD关注所有功能是否被正确实现，每一个功能都具备对应的测试用例，BDD关注整体行为是否符合预期，适合自顶向下的设计方式。
- 表达方式不同。TDD的表达式偏向于功能说明书的风格；BDD的表达方式更接近于自然语言的习惯。    

TDD风格的组织示意图：   
![](http://img.aisss.top/Foq50BPXwGgMCD64pL_xc0y9szRc)

BDD风格的组织示意图：   
![](http://img.aisss.top/FhsB4PnUoQ3XgcZsRS1HeANSBPKk)

#### 3. 测试用例
一个行为或者功能需要有完善、多方面的测试用例，一个测试用例中包含至少一个断言。      
Node中还有异步测试、超时设置

#### 4. 测试覆盖率

#### 5. mock

#### 6. 私有方法的测试

## 性能测试
单元测试主要用于检查代码的行为是否符合预期。在完成代码的行为检测后，还需要对已有的代码性能做出评估，检测已有功能是否满足能生产环境的性能要求，能否承担实际业务带来的压力。

### 基准测试
基准测试要统计的是在多少时间内执行了多少次某个方法。为了增强可比性，一般会以次数作为参照物，然后比较时间，以此来判断性能的差距。

### 压力测试
基准测试外，还要对网络接口进行压力测试以判断网络接口的性能。主要考擦指标有： 吞吐率、响应时间、并发数，这些都反应服务器都并发处理能力。
