---
title: 《你不知道的JavaScript-上》提升
date: 2017-10-25 17:07:57
categories:
- 读书笔记
- 《你不知道的JavaScript-上》
tags:
- JavaScript
- 系统学习
description: 有声明就有提升
---
**任何声明在某个作用域内的变量，都将附属于这个作用域**

## 先有鸡还是先有蛋
到底是声明（蛋）在前，还是赋值（鸡）在前？

## 编译器再度来袭
因为编译器在编译第二阶段——语法分析，会找到所有声明，并用合适的作用域将它们关联起来。    
正确的解释是：**变量和函数在内的所有声明都会在任何代码被执行之前首先被处理。**  

`var a=2`，其实会被JS看成两个声明：     
1. `var a`在编译阶段进行；
2. `a=2`赋值声明会被留在原地等待执行阶段。      
        
**提升：** 变量和函数声明从它们在代码中出现的位置被“移动”到了最上面。这个过程叫做提升。  
*只有声明本身会被提升。*      
*每个作用域都会进行提升操作。*


## 函数优先
函数声明和变量声明都会提升，但函数会首先被提升，然后才是变量。
```javascript
foo();   //1

var foo;

function foo(){
    console.log(1);
}

foo=function(){
    console.log(2);
};
```
会输出1而不是2！这个片段会被理解为
```javascript
function foo(){
    console.log(1);
}

foo();   //1

foo=function(){
    console.log(2);
};
```
重复的`var`声明会被忽略掉（*赋值初始化操作不会被忽略*），但出现在后面的函数声明还是可以覆盖前面的。
```javascript
foo();  //3

function foo(){
    console.log(1);
}

var foo=function(){
    console.log(2);
};

function foo(){
  console.log(3);  
}
```

## 小结
我们习惯将var a = 2; 看作一个声明，而实际上JavaScript引擎并不这么认为。它将var a 和a = 2 当作两个单独的声明，第一个是编译阶段的任务，而第二个则是执行阶段的任务。    
    
这意味着无论作用域中的声明出现在什么地方，都将在代码本身被执行前首先进行处理。可以将这个过程形象地想象成所有的声明（变量和函数）都会被“移动”到各自作用域的最顶端，这个过程被称为提升。            
    
声明本身会被提升，而包括函数表达式的赋值在内的赋值操作并不会提升。      
    
要注意避免重复声明，特别是当普通的var声明和函数声明混合在一起的时候，否则会引起很多危险的问题！